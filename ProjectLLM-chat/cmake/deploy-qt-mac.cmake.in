set(MACDEPLOYQT "@MACDEPLOYQT@")
set(COMPONENT_NAME_MAIN "@COMPONENT_NAME_MAIN@")
set(CMAKE_CURRENT_SOURCE_DIR "@CMAKE_CURRENT_SOURCE_DIR@")
set(ProjectLLM_SIGN_INSTALL "@ProjectLLM_SIGN_INSTALL@")
set(ProjectLLM_SIGNING_ID "@MAC_SIGNING_IDENTITY@")
set(CPACK_CONFIG_DIR "@CMAKE_BINARY_DIR@")
if (ProjectLLM_SIGN_INSTALL)
    set(MAC_NOTARIZE -sign-for-notarization=${ProjectLLM_SIGNING_ID})
endif()
execute_process(COMMAND ${MACDEPLOYQT} ${CPACK_TEMPORARY_INSTALL_DIRECTORY}/packages/${COMPONENT_NAME_MAIN}/data/bin/ProjectLLM.app -qmldir=${CMAKE_CURRENT_SOURCE_DIR} -verbose=2 ${MAC_NOTARIZE})
file(COPY "${CMAKE_CURRENT_SOURCE_DIR}/icons/ProjectLLM-32.png"
     DESTINATION ${CPACK_TEMPORARY_INSTALL_DIRECTORY}/packages/${COMPONENT_NAME_MAIN}/data)
file(COPY "${CMAKE_CURRENT_SOURCE_DIR}/icons/ProjectLLM-48.png"
     DESTINATION ${CPACK_TEMPORARY_INSTALL_DIRECTORY}/packages/${COMPONENT_NAME_MAIN}/data)
file(COPY "${CMAKE_CURRENT_SOURCE_DIR}/resources/ProjectLLM.icns"
     DESTINATION ${CPACK_TEMPORARY_INSTALL_DIRECTORY}/packages/${COMPONENT_NAME_MAIN}/data)

if (ProjectLLM_SIGN_INSTALL)
    # Create signed MaintenanceTool
    set(MT_DATA_DIR ${CPACK_TEMPORARY_INSTALL_DIRECTORY}/packages/maintenancetool/data)
    file(MAKE_DIRECTORY ${MT_DATA_DIR})
    execute_process(
        COMMAND binarycreator --config ${CPACK_CONFIG_DIR}/cpack-config/config/config.xml --create-maintenancetool --sign ${ProjectLLM_SIGNING_ID}
        WORKING_DIRECTORY ${MT_DATA_DIR}
    )
endif()
